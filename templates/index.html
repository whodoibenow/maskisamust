<!DOCTYPE html>
<html lang="en">
    <head>
        <title></title>
        <meta charset="UTF-8">
        <link href="static/style.css" rel="stylesheet">
    </head>
    <body>    
        <center>
            <div class='cont'>
                <h2>WELCOME<br> Face Mask Detector</h2>
            </div>
            

            <form method="POST" action="{{url_for('mask_image')}}" enctype="multipart/form-data">
                <input type="file" name='image' class='btn'><br><br><br>
                <input type="submit" class='btn'>
            </form>
            <form action="/upload" method="post" enctype="multipart/form-data" id = "form">
              <div align="center" style="margin-top:20px">
                  <div id="webcam" style="margin-bottom:10px"></div>
                  <input id="button" type="button" value="Check" class="btn btn-primary" onclick="snap()">
                  
                  </div>
              </div>
            </form>
            <div class="text-center" id="content"></div>
        </center>

    </body>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/webcamjs/1.0.26/webcam.min.js"></script>
    <script language="JavaScript">
            function ShowCam() {
                Webcam.set({
                    width: 320,
                    height: 240,
                    image_format: 'jpeg',
                    jpeg_quality: 100
                });
                Webcam.attach('#my_camera');
            }
            window.onload= ShowCam;

            function snap() {
                Webcam.snap( function(data_uri) {
                    // display results in page
                    document.getElementById('results').innerHTML = 
                    '<img id="image" src="'+data_uri+'"/>';
                  } );      
            }

            function upload() {
                
                var image = document.getElementById('image').src;
                var form = document.getElementById('form');
                var formData = new FormData(form);
                formData.append("file", image);
                var xmlhttp = new XMLHttpRequest();
                xmlhttp.open("POST", "/load_img");

                // check when state changes, 
                xmlhttp.onreadystatechange = function() {

                if(xmlhttp.readyState == 4 && xmlhttp.status == 200) {
                    alert(xmlhttp.responseText);
                    }
                }

                xmlhttp.send(formData);
                console.log(formData.get('file'));
                console.log(formData.get('userID'));
            }

  </script>

</html>
